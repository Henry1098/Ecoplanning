extern  bool  FCLOSE;

extern  int   PAGE_HEIGHT;
extern  int   PAGE_WIDTH;

extern int   SCALE_X;
extern int   SCALE_Y;
extern int   BM_W;
extern int   BM_H;

extern bool  LICKEY;

extern  bool VERSION;
extern int COL1,COL2,COL3,COL4,COL5,COL6,COL7,COL8,COL9,COL10,COL11,COL12,COL13,COL14,COL15;
extern int COL16,COL17,COL18,COL19,COL20;
extern char SEPCHAMPS;
extern char SEPPRED;

extern  char *m_modcrit;
extern  char *m_coche;
extern  char *m_filtre;
extern  char *m_project;
extern  char *m_exchange;
extern  char *m_exchange2;
extern  char *m_ecoplan;
extern  char *m_menu;
extern  char *DatabaseName;
extern  char *m_pasapas;
extern  char *m_criteres;
extern  char *m_sender;
extern  char *m_params;
extern  char *m_sort;
extern  char *m_tridetail;
extern  char *m_reports;
extern  char *m_origin;
extern  char *m_directory;
extern  char *m_message;
extern  char *m_planning;
extern char *m_rapport;
extern  char *m_help;
extern  char *m_dateprev;
extern  char *m_assign;
extern  char *m_memoriser;
extern  char *m_datefinreelle;

extern char *m_saveAV;
extern char *m_simul;
extern char *m_savesimul;
extern char *m_renum;
extern char *m_status;
extern char *m_excel;
extern char *m_importtaches;
extern char *m_importliaisons;
extern char *m_importcriteres;
extern char *m_save;
extern char *m_mode;
extern char *m_chcrit;
extern char *m_impt;
extern char *m_resize;
extern char *m_affect_crit;
extern char *m_zero;


extern char SAVEAS[MAX_PATH];

extern bool FIRST_AVANC;
extern char FILE_AVANC_DELETED[1000];
extern bool AVANC_DEL;
extern bool SAISIE_AVANC;

extern Graphics::TBitmap *im;
extern Graphics::TBitmap *imP;
extern Graphics::TBitmap *imR;
extern Graphics::TBitmap *img;

extern AnsiString DTFINPREV,DTFINREEL;

//extern char *m_renum;
extern char  dateavanc[5000];  // separes par des @
extern char  lastfile[400];
extern TStringList *TSL;
extern TStringList *TSLCRIT;

extern bool  L_BRISEES[10][20];
extern int  C_BRISEES[10][20];  // planning 1 à 10, 5 couleurs
extern float     E_BRISEES[10][20];

extern char TITRE[350];
extern char OBSERV[2000];

extern float TOTAL_POS;
extern float TOTAL_NEG;

extern int LASTTASK;

extern char   LastAppli[250];
extern char   LastPlanning[6][250];
extern AnsiString m_ghost_prep[6];

extern bool RELOADTRI[8];
extern  bool RELOADFILTRE[8];
extern  bool RELOADCOL[8];

extern int    PAGE_RAPPORT[8];    // Page en cours pour les rapports
extern int    MAX_PAGE_RAPPORT[8];
//extern int    MARQUEUR[2][200];    // marqueur pour les 2 rapports
//extern int    NEWY[2][200];        // nouveau Y de base
//extern int    ITEM_ENTETE[2];
//extern int    Y_ENTETE[2];

extern char       SPAGE[5000];    // image des pages de rapport
extern int        Y[5000];
extern AnsiString T[5000];
extern int        TCH[5000];
extern int        INDXPAGE;

extern char   AUTOMATE[6];   // memorise chargement plannings et rapport (origine)
//extern char   LastRapport[250];
extern char   LastTri[250];
extern char   LastCol[250];
extern char   LastFilter[250];
extern char   HelpDirectory[MAX_PATH];
extern char   ProjectDirectory[MAX_PATH];

extern char   LocalBase[MAX_PATH];
extern char   ProjectName[MAX_PATH];
extern int Numt[3000];
extern AnsiString Design[3000];
extern int Duree[3000];
extern AnsiString Deb[3000];
extern AnsiString Fin[3000];
extern AnsiString Criter[3000][8];
extern char P0[50],P1[50],P2[50],P3[50];
extern char BRUPT[5];
extern int DistDeb [3000];
extern int DistFin[3000];

extern char m_automatic[20];

#define COEF 100
#define COEFMM 10

extern AnsiString CRITERES[10];
extern AnsiString LIB_CRITERES[9];

extern Word    AnPrev,MoisPrev,JourPrev;
extern Word    AnFin,MoisFin,JourFin;
extern int     NB_TACHES;

#define MAX_T 3010
#define PS     300

#define NS     200
#define NN     300
extern int   niveaux[NN][MAX_T];
extern int   simul[MAX_T];
#define NB_CAL 5

extern int   duree[MAX_T];
extern int   duree_reelle[MAX_T];
extern char  flag_souhaites[MAX_T+10];

extern AnsiString CommentPL[8];
//char  libel[MAX_T][80];

extern int   pr[MAX_T][PS];
extern int su[MAX_T][PS];
extern int   pr_tl[MAX_T][PS];
extern int su_tl[MAX_T][PS];
extern int   pr_decal[MAX_T][PS];
extern int su_decal[MAX_T][PS];
extern int   deb_plus_tot[MAX_T];
extern int   fin_plus_tot[MAX_T];
extern int   deb_plus_tard[MAX_T];
extern int   fin_plus_tard[MAX_T];



extern int   vrai_deb_plus_tot[MAX_T];
extern int   vrai_fin_plus_tot[MAX_T];

extern int   retard[MAX_T];

extern char  coche[MAX_T];
extern char  coch[MAX_T];
extern char  filtr[MAX_T];
extern char  filtint[MAX_T];  //  sert aux calculs intermediaires



extern char codetache[MAX_T][30];

extern char  da[MAX_T][11]; // date avancement format YYYY-MM-DD
extern char  dtr[MAX_T][11];
extern char  ftr[MAX_T][11];
extern int   pca[MAX_T];
extern int   nbj[MAX_T];
extern char   tmom[MAX_T][11];
extern int   tcal[MAX_T+1];    //  calendriers affectes aux taches;
extern int   marg_tot[MAX_T];
extern int   marg_lib[MAX_T];
extern char  dds[MAX_T][11];
extern char  dfs[MAX_T][11];

extern int   sommets[MAX_T+1];



extern int   selection[MAX_T];

extern int   t_select[MAX_T];
extern int   t_selectf[MAX_T];
extern int   t_pred[MAX_T][PS];

extern int   renum[MAX_T];

#define MAX_PERIOD 100
extern AnsiString DebPer[MAX_PERIOD];
extern AnsiString FinPer[MAX_PERIOD];
extern int d1[MAX_PERIOD];
extern int d2[MAX_PERIOD];
extern int  DurPer[MAX_PERIOD];
extern int  PerPer[MAX_PERIOD];
extern int  TDuree[MAX_PERIOD];    // pour chaque calcul de tache
extern int  NbjtPer[MAX_PERIOD];
extern int  NbPer;

#define MAX_JOURS 8000
extern char   cal[NB_CAL+1][MAX_JOURS+1]; // 10 ans
extern char   weeks[NB_CAL+1][30];





 // Criteres et champs
#define MAX_CHAMPS  100
#define MAX_PLAN 7

extern int NUM_CHAMP[MAX_PLAN][MAX_CHAMPS];
// extern char LIBEL_CHAMP[MAX_PLAN][MAX_CHAMPS][50];

extern int  pc;  // planning_en_cours
extern int  rc;  // rapport en cours



extern char P_NOM[MAX_PLAN][200];   // Nom du Planning en cours
extern char P_GENRE[MAX_PLAN]; // compresse ou gantt
extern char P_TYPE[MAX_PLAN];  // prev ou prev+reel


extern bool P_PLANNING[MAX_PLAN];
extern bool P_RAPPORT[MAX_PLAN];


extern char *P_TRI[MAX_PLAN];
extern char *P_FILTRE[MAX_PLAN];
extern char *P_COLONNES[MAX_PLAN];

extern int NB_ITEMS_TRI[MAX_PLAN];
extern int NB_ITEMS_FILT[MAX_PLAN];
extern int NB_ITEMs_COL[MAX_PLAN];

extern char P_GRILLE[MAX_PLAN];
extern char P_LBRISE[MAX_PLAN];

extern int  NB_DETAIL[MAX_PLAN];


extern char P_MODE[MAX_PLAN];
extern int  P_H[MAX_PLAN],P_W[MAX_PLAN];
extern int  P_MARGH1[MAX_PLAN],P_MARGH2[MAX_PLAN],P_MARGV1[MAX_PLAN],P_MARGV2[MAX_PLAN];
extern AnsiString  P_MH1[MAX_PLAN],P_MH2[MAX_PLAN],P_MV1[MAX_PLAN],P_MV2[MAX_PLAN];


extern char P_MARGES[MAX_PLAN];
extern char P_CADRE[MAX_PLAN];  // O / N
extern char P_ENTETE[MAX_PLAN];
extern char P_CALHAUT[MAX_PLAN];
extern char P_CALBAS[MAX_PLAN];
extern char P_PIED[MAX_PLAN];
extern char P_MPENTETE[MAX_PLAN];
extern char P_MPPIED[MAX_PLAN];

// ENVELOPPE
/*
extern AnsiString P_ENV_COUL[MAX_PLAN];
extern AnsiString P_ENV_EPAIS[MAX_PLAN];
extern AnsiString P_ENV_STYLE[MAX_PLAN];
*/


// LOGO

extern AnsiString LOGONAME[MAX_PLAN];
extern AnsiString LOGOPOS[MAX_PLAN];


extern AnsiString  P_ELC[MAX_PLAN];    // epaisseur
extern AnsiString  P_CLC[MAX_PLAN];
extern int P_ELCF[MAX_PLAN];
extern int   P_CLCC[MAX_PLAN];


extern int P_RUPT[MAX_PLAN][8];

#define MAX_RUPT 200
extern AnsiString RUPT[MAX_RUPT];
extern int        NB_TASK[9][MAX_RUPT];
extern int        CTR_NB_TASK[9][MAX_RUPT];

extern int        ENV_MIN[9][MAX_RUPT];
extern int        ENV_MAX[9][MAX_RUPT];
extern int        ENV_DUR[MAX_RUPT];
extern int        ENV_D1[9][MAX_RUPT];
extern int        ENV_D2[9][MAX_RUPT];



extern int        NUM_CRIT[MAX_PLAN];  // dernier critere de rupture

extern TColor P_ET_BKG[MAX_PLAN];
extern TColor P_PD_BKG[MAX_PLAN];


// description des lignes details


extern int P_COL[MAX_PLAN]; // nb de colonnes (champs)
extern int P_DETAIL[MAX_PLAN];     // Detail dans TRI

#define MAX_COL 50

extern int P_LC[MAX_PLAN][MAX_COL];   // adresse x1;
extern int P_LENGTH[MAX_PLAN][MAX_COL];

extern AnsiString P_FIELD[MAX_PLAN][MAX_COL]; // Nom Variables

extern int P_NIV0[MAX_PLAN][MAX_COL];  // Sous Niveau pour le tri
extern int P_NIV1[MAX_PLAN][MAX_COL];
extern int P_NIV2[MAX_PLAN][MAX_COL];
extern int P_NIV3[MAX_PLAN][MAX_COL];
extern int P_ENV[MAX_PLAN][MAX_COL];
extern int P_TRICOL[MAX_PLAN][MAX_COL];   // numero de colonne dans ASTRI
extern char P_ATTR[MAX_PLAN][MAX_COL];   // attribut 'H' ou 'C'
extern AnsiString P_FONT[MAX_PLAN][MAX_COL];  // Nom de la fonte  dans la colonne
extern int  P_HAUT[MAX_PLAN][MAX_COL];   // Hauteur du texte dans la colonne
extern int  P_LARG[MAX_PLAN][MAX_COL];
extern AnsiString P_ITAL[MAX_PLAN][MAX_COL];    // Italic / Normal
extern AnsiString  P_BOLD[MAX_PLAN][MAX_COL];     // Bold / Normal
extern AnsiString P_JV[MAX_PLAN][MAX_COL];   //  justification V  'H,C,ou B'
extern AnsiString P_JH[MAX_PLAN][MAX_COL];   //  justification H  'G,C,D'
extern int  P_CFCOLOR[MAX_PLAN][MAX_COL];  // couleur Texte des colonnes
extern int  P_CBCOLOR[MAX_PLAN][MAX_COL];  // couleur Background


extern int  P_MAXSIZE[MAX_PLAN][MAX_COL];  // Taille du texte le plus long dans une colonne
extern int  P_EPAISSV[MAX_PLAN][MAX_COL];  // Epaisseur du  trait de la colonne "a gauche"

// idem pour les titres

extern int T_LC[MAX_PLAN][MAX_COL];   // adresse x1;
extern int T_LENGTH[MAX_PLAN][MAX_COL];
extern AnsiString T_FONT[MAX_PLAN][MAX_COL];  // Nom de la fonte  dans la colonne
extern int  T_HAUT[MAX_PLAN][MAX_COL];   // Hauteur du texte dans la colonne
extern int  T_LARG[MAX_PLAN][MAX_COL];
extern AnsiString  T_ITAL[MAX_PLAN][MAX_COL];    // Italic / Normal
extern AnsiString  T_BOLD[MAX_PLAN][MAX_COL];     // Bold / Normal
extern AnsiString T_JV[MAX_PLAN][MAX_COL];   //  justification V  'H,C,ou B'
extern AnsiString T_JH[MAX_PLAN][MAX_COL];   //  justification H  'G,C,D'
extern int  T_CFCOLOR[MAX_PLAN][MAX_COL];  // couleur Texte des colonnes
extern int  T_CBCOLOR[MAX_PLAN][MAX_COL];  // couleur Background
extern AnsiString T_TITRE_COL[MAX_PLAN][50];  // Titre des colonnes


extern char       LSH[MAX_PLAN][MAX_COL];    // LSep Haute Oui/Non
extern TColor     LSH_COLOR[MAX_PLAN][MAX_COL];   // couleur ligne
extern int        LSH_STYLE[MAX_PLAN][MAX_COL];   // style ligne
extern int        LSH_EPAISSEUR[MAX_PLAN][MAX_COL];  // Epaisseur
extern char       LSB[MAX_PLAN][MAX_COL];    // LSep Basse Oui/Non
extern TColor     LSB_COLOR[MAX_PLAN][MAX_COL];   // couleur ligne
extern int        LSB_STYLE[MAX_PLAN][MAX_COL];   // style ligne
extern int        LSB_EPAISSEUR[MAX_PLAN][MAX_COL];  // Epaisseur

#define MT 5
//  1 = Prev Crit  2=Prev Non Crit  3=Reel Crit  4 Reel Non Crit
extern AnsiString P_TRAIT[MAX_PLAN][MT];
extern AnsiString P_EPTRAIT[MAX_PLAN][MT];

extern AnsiString P_LIENS[MAX_PLAN][MT];
extern AnsiString P_MARGE[MAX_PLAN][MT];
extern AnsiString P_STYLEM[MAX_PLAN][MT];
extern AnsiString P_COLMARGE[MAX_PLAN][MT];

extern AnsiString P_INF[MAX_PLAN][MT][4];
extern AnsiString P_INFO[MAX_PLAN][MT][4];
extern AnsiString P_POLT[MAX_PLAN][MT][4];
extern AnsiString P_COLTXTF[MAX_PLAN][MT][4];   // couleur texte
extern AnsiString P_COLTXTB[MAX_PLAN][MT][4];   // couleur de fond
extern AnsiString P_ITALT[MAX_PLAN][MT][4]; //
extern AnsiString P_BOLDT[MAX_PLAN][MT][4]; //
extern AnsiString P_SIZET[MAX_PLAN][MT][4]; //

extern AnsiString P_STYLELIEN[MAX_PLAN][MT];
extern AnsiString P_COL_LIEN[MAX_PLAN][MT];
extern AnsiString P_EPAIS_LIEN[MAX_PLAN][MT];






extern int  P_DEBUTGANTT[MAX_PLAN];   // debut du gantt et du calendrier
extern int  P_DEBUTCOL[MAX_PLAN];

extern int H_CAL1[MAX_PLAN],H_CAL2[MAX_PLAN],H_COPYRIGHT[MAX_PLAN];
extern AnsiString P_FORMATCAL1[MAX_PLAN], P_FORMATCAL2[MAX_PLAN];
extern AnsiString P_FREQ1[MAX_PLAN], P_FREQ2[MAX_PLAN];
extern AnsiString P_UNIT1[MAX_PLAN],P_UNIT2[MAX_PLAN];
extern AnsiString P_ECHH[MAX_PLAN];
extern AnsiString P_ECHB[MAX_PLAN];



#define  MAX_TEXTE   150

extern AnsiString PACTIF[MAX_PLAN][MAX_TEXTE];  //  actif ou non, surtout pour les criteres 3..4..5..6..
extern char       P_ORIENT[MAX_PLAN][MAX_TEXTE];  // En Ligne = true, en colonne = false
extern AnsiString PT[MAX_PLAN][MAX_TEXTE];    // Texte
extern TColor     PC[MAX_PLAN][MAX_TEXTE];    // Couleur Foreground
extern TColor     PB[MAX_PLAN][MAX_TEXTE];    // backgroung
extern AnsiString PF[MAX_PLAN][MAX_TEXTE];    // Fonte Name
extern int        PH[MAX_PLAN][MAX_TEXTE];    // size = taille
extern int        PHH[MAX_PLAN][MAX_TEXTE];    // hauteur
extern AnsiString PN[MAX_PLAN][MAX_TEXTE];    // italique I normal =  N
extern AnsiString PX[MAX_PLAN][MAX_TEXTE];    // bold  = B ou Regulier  N
extern AnsiString PJH[MAX_PLAN][MAX_TEXTE];   // just H
extern AnsiString PJV[MAX_PLAN][MAX_TEXTE];   // just V
extern int        PR[MAX_PLAN][MAX_TEXTE];    // Retrait;
extern char       PTYPE[MAX_PLAN][MAX_TEXTE];  // type impression pour crit : Ligne ou Colonne




/*



extern char       LSH[MAX_PLAN][MAX_TEXTE];    // LSep Haute Oui/Non
extern TColor     LSH_COLOR[MAX_PLAN][MAX_TEXTE];   // couleur ligne
extern int        LSH_STYLE[MAX_PLAN][MAX_TEXTE];   // style ligne
extern int        LSH_EPAISSEUR[MAX_PLAN][MAX_TEXTE];  // Epaisseur
extern char       LSB[MAX_PLAN][MAX_TEXTE];    // LSep Basse Oui/Non
extern TColor     LSB_COLOR[MAX_PLAN][MAX_TEXTE];   // couleur ligne
extern int        LSB_STYLE[MAX_PLAN][MAX_TEXTE];   // style ligne
extern int        LSB_EPAISSEUR[MAX_PLAN][MAX_TEXTE];  // Epaisseur
*/

// CORPS

 #define CHOIX 9
extern AnsiString P_CYN[MAX_PLAN][CHOIX];
extern AnsiString P_CCFG[MAX_PLAN][CHOIX];
//extern AnsiString P_CCBK[MAX_PLAN][CHOIX];
extern AnsiString P_CCST[MAX_PLAN][CHOIX];
extern AnsiString P_CCEP[MAX_PLAN][CHOIX];

extern AnsiString P_CYNJT[MAX_PLAN];
extern AnsiString P_CYNJNT[MAX_PLAN];
extern AnsiString P_CYNWENT[MAX_PLAN];
extern AnsiString P_CJTFLAG[MAX_PLAN];
extern AnsiString P_CJT[MAX_PLAN];
extern AnsiString P_CJNT[MAX_PLAN];
extern AnsiString P_CWENT[MAX_PLAN];
extern AnsiString P_CDH[MAX_PLAN];
extern AnsiString P_CDV[MAX_PLAN];

extern AnsiString P_CCJT[MAX_PLAN];
extern AnsiString P_CCJNT[MAX_PLAN];
extern AnsiString P_CCWENT[MAX_PLAN];







// VARIABLES INTERMEDIAIRES DE CALCUL;

extern int memy1[MAX_PLAN],memy2[MAX_PLAN];
extern int P_MAXDIST[MAX_PLAN];
extern int P_DECAL[MAX_PLAN];
extern int P_LASTTEXT[MAX_PLAN];
extern int P_LST[MAX_PLAN];

extern int P_CDVV[MAX_PLAN];

extern int LAST_RX1[MAX_PLAN];
extern int LAST_RX2[MAX_PLAN];
extern int LAST_RY1[MAX_PLAN];
extern int LAST_RY2[MAX_PLAN];
extern int LAST_ZOOM[MAX_PLAN];
extern char LAST_TYPE[MAX_PLAN];

extern int LAST_X1;
extern int LAST_X2;
extern int LAST_Y1;
extern int LAST_Y2;
extern int LAST_TYP;
extern int LAST_ZOM;

extern int  D_LEFT[MAX_PLAN];
extern int  D_RIGHT[MAX_PLAN];
extern int  D_TOP[MAX_PLAN];
extern int  D_BOTTOM[MAX_PLAN];


#define MAX_TRI 8
extern AnsiString S_CRIT[MAX_TRI][4];

#define MAX_TCHP 8

extern AnsiString  T_LLCC[MAX_PLAN][MAX_TCHP];  // valeur L ou C
extern AnsiString  T_POL[MAX_PLAN][MAX_TCHP]; // police
extern AnsiString  T_CTEXT[MAX_PLAN][MAX_TCHP]; // couleur Texte
extern AnsiString  T_TITAL[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_TBOLD[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_HAUTEUR[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_JSH[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_JSV[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_CBKG[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_TLARG[MAX_PLAN][MAX_TCHP];

extern AnsiString  T_LS1[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_LS1EP[MAX_PLAN][MAX_TCHP];    // Epaisseur
extern AnsiString  T_LS1CL[MAX_PLAN][MAX_TCHP];    // Couleur
extern AnsiString  T_LS1ST[MAX_PLAN][MAX_TCHP];    // Style

extern AnsiString  T_LS2[MAX_PLAN][MAX_TCHP];      // Oui/Non (pour titre en ligne)
extern AnsiString  T_LS2EP[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_LS2CL[MAX_PLAN][MAX_TCHP];
extern AnsiString  T_LS2ST[MAX_PLAN][MAX_TCHP];    // Style

extern AnsiString  E_ENV[MAX_PLAN][MAX_TCHP];   // Oui ou Non
extern AnsiString  E_POL[MAX_PLAN][MAX_TCHP]; // police
extern AnsiString  E_CTEXT[MAX_PLAN][MAX_TCHP]; // couleur Texte
extern AnsiString  E_TITAL[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_TBOLD[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_HAUTEUR[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_JSH[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_JSV[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_CBKG[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_TLARG[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_COULTRAIT[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_STYLE[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_EPAISS[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_DESIGN[MAX_PLAN][MAX_TCHP];
extern AnsiString  E_ENCADR[MAX_PLAN][MAX_TCHP];
extern int nrtaches[MAX_T];
extern int compteurt; // Pour compter les nombres des taches qui ont une marge supérieure à zero
extern bool choixperiode;
extern int appuiprep;
